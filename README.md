# DatasetCreator

Code to extract annotated images from GTAV. The annotations contain keypoints as well as semantic segmentation maps. Moreover, 
a tool is provided to create new scenes, which can be subsequently recorded. The repository 
is fuses and extends functionality from [GTAVisionExport](https://github.com/umautobots/GTAVisionExport) and [JTA-Mods](https://github.com/fabbrimatteo/JTA-Mods).

The repository is structured as follows:
* The `ScenarioCreator`-directory contains code for the creation of new scenes and their storing.
* The `native`-directory contains code to load the saved scenes and record these including keypoins- and semantic-maps-annotations.

In the following descriptions `$(ROOT)` will refer to the path to the root of this repository


## Test set-up:

The repository is tested with the following setup:

+ **FIXME: add GPU** 
+ Windows 10 64bit
+ Visual Studio 2017 (enterprise edition, but should also work with community edition) and Visual Studio 2019 
+ cmake-gui (version 3.15.3)
+ GTA-V version 1.0.231.0

## Required tools and libraries

+ [AsiLoader and ScriptHookV](http://www.dev-c.com/gtav/scripthookv/): Download the archive containing the Asi Loader and Native Trainer as well as the SDK an extract them.

+ [CMake](https://cmake.org/download/): Install the windows version (I used the installer that's provided under `Binary Distributions`)

+ [MS Visual Studio](https://www.visualstudio.com/cs/downloads/): Download and install

##Prerequisities

* Copy the `$(ROOT)/param/` and `$(ROOT)/scenarios/` folders to the exe-folder of GTA-V. 
* The `$(ROOT)/param/` contains predefined parameters for the _ScenarioCreator_ and _DatasetExporter_. These are required. Without these, the mods not be load propperly when launching the game.
* The `$(ROOT)/scenarios/` contains predfined that were generated by the _ScenarioCreator_. With these, the _DatasetCreator_ mod can be tested. 


## Running GTA-V


* **Important**: To get the image capturing to work, you have to run GTA-V in **Windowed Borderless** mode. To configure this, select **Windowed Borderless** as **Screen Type** option in GTA's _Graphic Options_. To extract valid semantic segmentation maps, set the option _Ignore Suggested Limits_ in the same menu to **On**.
* For the _Scren Resolution_ option, it is recommended to choose 1920x1080. If an alternative _Screen Resolution_ is chosen, the `screen_width` and `screen_height` parameters in the file `param/parameters.txt`, that was copied to the GTA-V exe-folder in the [Prerequisities](#prerequisities) step, have to be changed accordingly.
* In the _Display_ options, turn off _HUD_ and disable _Radar_.

